{
    "@type": "Workflow",
    "triggerLimit": null,
    "name": "> Get Appliance Detail",
    "aliasName": null,
    "tag": null,
    "description": "Playbook gets Appliance detail from Nozomi CMC by Appliance ID.",
    "isActive": true,
    "debug": false,
    "singleRecordExecution": false,
    "remoteExecutableFlag": false,
    "parameters": [
        "applianceId"
    ],
    "synchronous": false,
    "collection": "\/api\/3\/workflow_collections\/566483c2-686f-4c7d-b8df-eb51583b1814",
    "versions": [],
    "triggerStep": "\/api\/3\/workflow_steps\/cbed0467-ba56-4c5b-a76a-890ffcb317aa",
    "steps": [
        {
            "@type": "WorkflowStep",
            "name": "Configuration",
            "description": null,
            "arguments": {
                "useMockOutput": "{{globalVars.Demo_mode}}"
            },
            "status": null,
            "top": "165",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "group": null,
            "uuid": "ecad95ea-cb8d-4fa4-8d9a-48684027276c"
        },
        {
            "@type": "WorkflowStep",
            "name": "Create Appliance Comment",
            "description": null,
            "arguments": {
                "when": "{{vars.steps.Get_Appliance_Details.data.result | length > 0}}",
                "resource": {
                    "type": "\/api\/3\/picklists\/ff599189-3eeb-4c86-acb0-a7915e85ac3b",
                    "people": [],
                    "content": "<h4>Appliance Details<\/h4>\n<table>\n<tbody>\n<tr>\n<th>Appliance Id:<\/th>\n<td>{{vars.steps.Get_Appliance_Details.data.result[0]['id']}}<\/td>\n<\/tr>\n<tr>\n<th>Appliance IP:<\/th>\n<td>{{vars.steps.Get_Appliance_Details.data.result[0]['ip']}}<\/td>\n<\/tr>\n<tr>\n<th>Appliance Hostname:<\/th>\n<td>{{vars.steps.Get_Appliance_Details.data.result[0]['host']}}<\/td>\n<\/tr>\n<tr>\n<th>Appliance Type:<\/th>\n<td>{{vars.steps.Get_Appliance_Details.data.result[0]['info']['appliance_type']}}<\/td>\n<\/tr>\n<\/tbody>\n<\/table>",
                    "__replace": "",
                    "isImportant": false,
                    "peopleUpdated": false
                },
                "operation": "Overwrite",
                "collection": "\/api\/3\/comments",
                "__recommend": [],
                "fieldOperation": {
                    "recordTags": "Overwrite"
                },
                "step_variables": []
            },
            "status": null,
            "top": "435",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/2597053c-e718-44b4-8394-4d40fe26d357",
            "group": null,
            "uuid": "9b8888eb-1b89-49cf-9f9d-25b4a675c7a8"
        },
        {
            "@type": "WorkflowStep",
            "name": "Get Appliance Details",
            "description": null,
            "arguments": {
                "name": "Nozomi Networks Central Management Console",
                "config": "b7cfa08d-0c1d-40a0-8ad9-efe8f6ca7e33",
                "params": {
                    "query": "",
                    "appliance_ids": "{{vars.input.params.applianceId}}"
                },
                "version": "1.0.0",
                "connector": "nozomi-networks-central-management-console",
                "operation": "get_appliances",
                "mock_result": "{\n  \"data\": {\n    \"total\": 1,\n    \"header\": [\n      \"ip\",\n      \"last_sync\",\n      \"id\",\n      \"info\",\n      \"allowed\",\n      \"sync_throughput\",\n      \"is_updating\",\n      \"map_position\",\n      \"previous_alerts_count_last_5m\",\n      \"version_locked\",\n      \"site\",\n      \"host\",\n      \"time\",\n      \"synchronized\",\n      \"replicated\",\n      \"deleted_at\",\n      \"health\",\n      \"appliance_id\",\n      \"appliance_ip\",\n      \"appliance_host\",\n      \"force_update\",\n      \"model\",\n      \"last_seen_packet\",\n      \"bpf_filters_to_be_propagated\",\n      \"have_bpf_filters_changed\",\n      \"certificate_exchange_status\",\n      \"denylists_to_be_propagated\",\n      \"have_denylists_changed\",\n      \"rc_has_connection_errors\"\n    ],\n    \"result\": [\n      {\n        \"id\": \"1fb4918e-ed88-4717-82ec-28fec97dd6be\",\n        \"ip\": \"10.132.254.15\",\n        \"host\": \"nozomi-n2os.local\",\n        \"info\": {\n          \"data\": {\n            \"free\": \"4.5G\",\n            \"used\": \"88M\",\n            \"total\": \"4.6G\",\n            \"status\": \"ok\",\n            \"free_perc\": 99,\n            \"used_perc\": \"1\"\n          },\n          \"host\": \"nozomi-n2os.local\",\n          \"risk\": 0,\n          \"site\": \"\",\n          \"time\": 1679465935783,\n          \"model\": \"V-SERIES\",\n          \"uptime\": {\n            \"days\": 122,\n            \"hours\": 15,\n            \"minutes\": 25,\n            \"seconds\": 37.74638390541077\n          },\n          \"cpu_perc\": 4,\n          \"last_cmc\": \"nozomi-n2os.local\",\n          \"mem_free\": 1931,\n          \"mem_used\": 2125,\n          \"all_speed\": 9512.5,\n          \"machine_id\": \"564d630b-c559-c470-337c-8fbe5220191a\",\n          \"ntp_offset\": \"n\/a\",\n          \"description\": \"\",\n          \"has_low_ram\": false,\n          \"has_sp_code\": false,\n          \"links_count\": \"1163\",\n          \"nodes_count\": \"1204\",\n          \"alerts_count\": 862,\n          \"assets_count\": \"488\",\n          \"fips_enabled\": false,\n          \"license_base\": {\n            \"type\": \"base\",\n            \"extra\": {\n              \"expire_date\": \"1678233600000\",\n              \"supported_nodes\": \"30000\",\n              \"actual_licensed_nodes\": \"1016\"\n            },\n            \"status\": \"EXPIRING\",\n            \"licensee\": \"Fortinet - FortiSOAR Integration Dev.\",\n            \"can_be_set\": true,\n            \"license_id\": \"f567f0c0-3524-4aa4-8c04-10269dfce44f\",\n            \"bundle_name\": \"full_advanced\",\n            \"is_disabled\": false,\n            \"hard_expire_date\": \"1686009600000\",\n            \"license_machine_id\": \"564d630b-c559-c470-337c-8fbe5220191a\"\n          },\n          \"n2os_version\": \"22.5.0-10040913_E7B69\",\n          \"appliance_mode\": \"not_applicable\",\n          \"appliance_type\": \"guardian\",\n          \"has_sp_license\": false,\n          \"update_message\": null,\n          \"disk_usage_perc\": 1,\n          \"time_utc_offset\": \"+00:00\",\n          \"variables_count\": \"1633\",\n          \"throughput_series\": [\n            [\n              \"all:bytes\",\n              [\n                [\n                  1679380200000,\n                  292517.87583\n                ],\n                [\n                  1679381100000,\n                  920538.68972\n                ],\n                [\n                  1679382000000,\n                  1277852.5722\n                ],\n                [\n                  1679382900000,\n                  178184.57833\n                ],\n                [\n                  1679383800000,\n                  124440.05944\n                ],\n                [\n                  1679384700000,\n                  166819.29556\n                ],\n                [\n                  1679385600000,\n                  35009.242222\n                ],\n                [\n                  1679386500000,\n                  98623.988333\n                ],\n                [\n                  1679387400000,\n                  88914.058333\n                ],\n                [\n                  1679388300000,\n                  222314.49889\n                ],\n                [\n                  1679389200000,\n                  124717.95333\n                ],\n                [\n                  1679390100000,\n                  142276.49722\n                ],\n                [\n                  1679391000000,\n                  114350.06056\n                ],\n                [\n                  1679391900000,\n                  229251.56444\n                ],\n                [\n                  1679392800000,\n                  179932.25722\n                ],\n                [\n                  1679393700000,\n                  45985.746667\n                ],\n                [\n                  1679394600000,\n                  155703.24833\n                ],\n                [\n                  1679395500000,\n                  165678.37167\n                ],\n                [\n                  1679396400000,\n                  65449.798889\n                ],\n                [\n                  1679397300000,\n                  77794.769722\n                ],\n                [\n                  1679398200000,\n                  45977.046389\n                ],\n                [\n                  1679399100000,\n                  133011.72\n                ],\n                [\n                  1679400000000,\n                  92027.846944\n                ],\n                [\n                  1679400900000,\n                  152761.55583\n                ],\n                [\n                  1679401800000,\n                  131834.07833\n                ],\n                [\n                  1679402700000,\n                  153885.14111\n                ],\n                [\n                  1679403600000,\n                  88984.759722\n                ],\n                [\n                  1679404500000,\n                  82974.706111\n                ],\n                [\n                  1679405400000,\n                  2135287.9236\n                ],\n                [\n                  1679406300000,\n                  356036.32111\n                ],\n                [\n                  1679407200000,\n                  74297.460278\n                ],\n                [\n                  1679408100000,\n                  84802.506944\n                ],\n                [\n                  1679409000000,\n                  118013.14472\n                ],\n                [\n                  1679409900000,\n                  171468.69972\n                ],\n                [\n                  1679410800000,\n                  86443.958889\n                ],\n                [\n                  1679411700000,\n                  57313.842778\n                ],\n                [\n                  1679412600000,\n                  66001.562778\n                ],\n                [\n                  1679413500000,\n                  137554.13028\n                ],\n                [\n                  1679414400000,\n                  38506.247778\n                ],\n                [\n                  1679415300000,\n                  41176.751944\n                ],\n                [\n                  1679416200000,\n                  37074.046667\n                ],\n                [\n                  1679417100000,\n                  252504.41444\n                ],\n                [\n                  1679418000000,\n                  113005.55833\n                ],\n                [\n                  1679418900000,\n                  45005.354167\n                ],\n                [\n                  1679419800000,\n                  38307.368611\n                ],\n                [\n                  1679420700000,\n                  125932.49444\n                ],\n                [\n                  1679421600000,\n                  35981.187778\n                ],\n                [\n                  1679422500000,\n                  33945.723333\n                ],\n                [\n                  1679423400000,\n                  36031.219722\n                ],\n                [\n                  1679424300000,\n                  134512.3675\n                ],\n                [\n                  1679425200000,\n                  98446.441944\n                ],\n                [\n                  1679426100000,\n                  54813.589722\n                ],\n                [\n                  1679427000000,\n                  35282.123889\n                ],\n                [\n                  1679427900000,\n                  125539.36861\n                ],\n                [\n                  1679428800000,\n                  32786.591944\n                ],\n                [\n                  1679429700000,\n                  32764.693889\n                ],\n                [\n                  1679430600000,\n                  36360.702222\n                ],\n                [\n                  1679431500000,\n                  127522.26944\n                ],\n                [\n                  1679432400000,\n                  33222.769167\n                ],\n                [\n                  1679433300000,\n                  34806.348611\n                ],\n                [\n                  1679434200000,\n                  34196.097556\n                ],\n                [\n                  1679435100000,\n                  132543.06967\n                ],\n                [\n                  1679436000000,\n                  33756.143056\n                ],\n                [\n                  1679436900000,\n                  35882.998611\n                ],\n                [\n                  1679437800000,\n                  35254.772778\n                ],\n                [\n                  1679438700000,\n                  125547.39833\n                ],\n                [\n                  1679439600000,\n                  33062.45\n                ],\n                [\n                  1679440500000,\n                  34831.930833\n                ],\n                [\n                  1679441400000,\n                  34386.801389\n                ],\n                [\n                  1679442300000,\n                  124797.57583\n                ],\n                [\n                  1679443200000,\n                  40806.378056\n                ],\n                [\n                  1679444100000,\n                  32174.192778\n                ],\n                [\n                  1679445000000,\n                  32044.327778\n                ],\n                [\n                  1679445900000,\n                  125370.57667\n                ],\n                [\n                  1679446800000,\n                  32759.432222\n                ],\n                [\n                  1679447700000,\n                  34559.700556\n                ],\n                [\n                  1679448600000,\n                  32697.943889\n                ],\n                [\n                  1679449500000,\n                  124726.13833\n                ],\n                [\n                  1679450400000,\n                  32964.969444\n                ],\n                [\n                  1679451300000,\n                  33096.005556\n                ],\n                [\n                  1679452200000,\n                  35300.726667\n                ],\n                [\n                  1679453100000,\n                  125303.52083\n                ],\n                [\n                  1679454000000,\n                  65159.763611\n                ],\n                [\n                  1679454900000,\n                  65823.401111\n                ],\n                [\n                  1679455800000,\n                  44497.545556\n                ],\n                [\n                  1679456700000,\n                  139811.40222\n                ],\n                [\n                  1679457600000,\n                  52670.553333\n                ],\n                [\n                  1679458500000,\n                  113200.08722\n                ],\n                [\n                  1679459400000,\n                  119488.95722\n                ],\n                [\n                  1679460300000,\n                  174097.705\n                ],\n                [\n                  1679461200000,\n                  150950.09278\n                ],\n                [\n                  1679462100000,\n                  49896.975556\n                ],\n                [\n                  1679463000000,\n                  98577.79\n                ],\n                [\n                  1679463900000,\n                  151584.80472\n                ],\n                [\n                  1679464800000,\n                  74581.613056\n                ],\n                [\n                  1679465700000,\n                  66017.954444\n                ],\n                [\n                  1679466600000,\n                  66017.954444\n                ]\n              ]\n            ]\n          ],\n          \"has_reached_limits\": true,\n          \"is_under_high_load\": true,\n          \"network_interfaces\": \"em1\",\n          \"alerts_count_last_5m\": 0,\n          \"has_migration_errors\": false,\n          \"license_smart_polling\": {\n            \"type\": \"smart_polling\",\n            \"extra\": {\n              \"expire_date\": \"0\"\n            },\n            \"status\": \"UNLICENSED\",\n            \"licensee\": \"Unregistered\",\n            \"can_be_set\": true,\n            \"license_id\": null,\n            \"is_disabled\": false,\n            \"license_machine_id\": null\n          },\n          \"license_asset_intelligence\": {\n            \"type\": \"asset_intelligence\",\n            \"extra\": {\n              \"expire_date\": \"1678233600000\"\n            },\n            \"status\": \"EXPIRING\",\n            \"licensee\": \"Fortinet - FortiSOAR Integration Dev.\",\n            \"can_be_set\": true,\n            \"license_id\": \"242e8d1f-b4f2-4904-b977-299fa532f016\",\n            \"is_disabled\": false,\n            \"hard_expire_date\": \"1686009600000\",\n            \"license_machine_id\": \"564d630b-c559-c470-337c-8fbe5220191a\"\n          },\n          \"license_threat_intelligence\": {\n            \"type\": \"update_service\",\n            \"extra\": {\n              \"expire_date\": \"1678233600000\"\n            },\n            \"status\": \"EXPIRING\",\n            \"licensee\": \"Fortinet - FortiSOAR Integration Dev.\",\n            \"can_be_set\": true,\n            \"license_id\": \"ae0da11e-7fe0-4ca3-be52-1061ecdea098\",\n            \"is_disabled\": false,\n            \"hard_expire_date\": \"1686009600000\",\n            \"license_machine_id\": \"564d630b-c559-c470-337c-8fbe5220191a\"\n          }\n        },\n        \"site\": \"\",\n        \"time\": 0,\n        \"model\": \"V-SERIES\",\n        \"health\": {\n          \"stale\": false,\n          \"status\": 100\n        },\n        \"allowed\": true,\n        \"last_sync\": 1679465940630,\n        \"deleted_at\": 0,\n        \"replicated\": false,\n        \"is_updating\": false,\n        \"appliance_id\": null,\n        \"appliance_ip\": null,\n        \"force_update\": false,\n        \"map_position\": null,\n        \"synchronized\": false,\n        \"appliance_host\": null,\n        \"version_locked\": false,\n        \"sync_throughput\": 2245295821,\n        \"last_seen_packet\": null,\n        \"have_denylists_changed\": false,\n        \"have_bpf_filters_changed\": false,\n        \"rc_has_connection_errors\": false,\n        \"denylists_to_be_propagated\": {},\n        \"certificate_exchange_status\": 0,\n        \"bpf_filters_to_be_propagated\": null,\n        \"previous_alerts_count_last_5m\": null\n      }\n    ]\n  }\n}",
                "operationTitle": "Get Appliances",
                "pickFromTenant": false,
                "step_variables": []
            },
            "status": null,
            "top": "300",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/0bfed618-0316-11e7-93ae-92361f002671",
            "group": null,
            "uuid": "e9c109a9-b792-44ac-8c03-b4e35d926961"
        },
        {
            "@type": "WorkflowStep",
            "name": "Start",
            "description": null,
            "arguments": {
                "step_variables": {
                    "input": {
                        "params": []
                    }
                }
            },
            "status": null,
            "top": "30",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/b348f017-9a94-471f-87f8-ce88b6a7ad62",
            "group": null,
            "uuid": "cbed0467-ba56-4c5b-a76a-890ffcb317aa"
        }
    ],
    "routes": [
        {
            "@type": "WorkflowRoute",
            "name": "Configuration -> Get Node CVEs",
            "targetStep": "\/api\/3\/workflow_steps\/e9c109a9-b792-44ac-8c03-b4e35d926961",
            "sourceStep": "\/api\/3\/workflow_steps\/ecad95ea-cb8d-4fa4-8d9a-48684027276c",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "1a0240d0-04d6-4295-8883-5da1195fd0b9"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Get Appliance Details -> Create Appliance Comment",
            "targetStep": "\/api\/3\/workflow_steps\/9b8888eb-1b89-49cf-9f9d-25b4a675c7a8",
            "sourceStep": "\/api\/3\/workflow_steps\/e9c109a9-b792-44ac-8c03-b4e35d926961",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "54d8112e-b615-4d99-9c86-d9f93edb6bff"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Start -> Configuration",
            "targetStep": "\/api\/3\/workflow_steps\/ecad95ea-cb8d-4fa4-8d9a-48684027276c",
            "sourceStep": "\/api\/3\/workflow_steps\/cbed0467-ba56-4c5b-a76a-890ffcb317aa",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "347cdb1c-dd96-4e8c-93a8-419aa3aa7947"
        }
    ],
    "groups": [],
    "priority": "\/api\/3\/picklists\/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
    "uuid": "119fa49b-b098-4618-8d3b-320587380959",
    "owners": [],
    "isPrivate": false,
    "deletedAt": null,
    "recordTags": [
        "Alert",
        "Referenced",
        "Nozomi",
        "Appliance"
    ]
}